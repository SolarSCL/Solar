<p align="center">
  <img alt="Solar" align="center" src=".github/logo.svg"/>
</p>
<br/>
> Analyze your project on SCL with Solar.

## Introduction

Solar (pronounced [soˈlaɾ]) is a .......

## Формат отображения результатов анализа

После проведения анализа файла, Solar выдает результаты в простом и понятном формате, максимально подробно описывая событие.
Сообщение состоит из трех частей:
1. Описание элемента на котором произошло событие, как правило, это элемент файла. Например, IED, DOI, SampledValueControl или ConnectedAP

2. Описание параметров элемента таких, как:  
   * строка в файле, на которой находится элемент. Это сделано для удобства, так как зачастую в файле присутствует много похожих элементов и единственный способ их различать это знать положение в файле
   
   * аттрибуты элемента, присутствуют для того чтобы можно было сделать оценочные суждения не открывая файл.

3. Описание событий элемента. В этой части Solar дает подробную расшифровку события. Начиная от оценки уровня критичности события, заканчивая рекомендациями, если Solar может их предоставить.

<p align="center">
  <img alt="Data" align="center" src=".github/post.png"/>
</p>

## О событиях при анализе

Solar разделяет события анализа на 4 группы по степени критической важности
* Status
* Warning
* Error
* Fatal Error

## Usage

Solar представляет анализ файла в виде представленных ниже основных этапов:
* [Поиск синтаксических ошибок при сопоставлении с описанием структуры языка SCL](#поиск-синтаксических-ошибок-при-сопоставлении-с-описанием-структуры-языка-scl)
* [Сопоставление значений аттрибутов с шаблонами](#сопоставление-с-шаблонами)  
* [Анализ раздела описания коммуникаций(подсетей)](#анализ-раздела-описания-подсетей)
* [Анализ распределения нагрузки на виртуальные подсети](#анализ-распределения-нагрузки-на-виртуальные-подсети)
* [Анализ раздела описания типов данных](#анализ-раздела-описания-типов-данных)
* [Анализ раздела описания истории изменений файла](#анализ-раздела-описания-истории-изменений-файла)
* [Анализ раздела описания моделей данных ИЭУ(IED)](#анализ-раздела-описания-моделей-данных-ИЭУ)
* [Анализ раздела описания однолинейных схем](#анализ-раздела-описания-однолинейных-схем)
* [Анализ раздела входных сигналов для каждого ИЭУ](#анализ-раздела-входных-сигналов-для-каждого-ИЭУ)
* [Анализ избыточных\неиспользуемых элементов в наборах данных](#анализ-избыточных-или-неиспользуемых-элементов-в-наборах-данных)

## Поиск синтаксических ошибок при сопоставлении с описанием структуры языка SCL

Solar умеет распознавать синтаксис и структуру языка SCL и проводить синтаксический анализ. Поэтому все события связанные с синтаксисом Solar будет относить к элементу "Синтаксис". 
Элементу синтаксиса нельзя сопоставить номер строки, так как он охватывает весь анализируемый файл целиком.
В связи с этим Solar номера строк к каждому отдельно взятому событию.

## Сопоставление с шаблонами

SCL содержит огромное количество шаблонов, с которыми файл должен быть успешно сопоставлен во время анализа. Сопоставление с шаблонами принимает разные формы, далее будет приведена лишь малая их часть:
* значения аттрибутов должны соответствовать определенным правилам, например некоторые аттрибуты не должны содержать цифр
* часть аттрибутов должна иметь строго фиксированное значение, например inst у LN0, может принимать только значение пустой строки
* часть аттрибутов должна присутствовать всегда, например аттрибут name у IED
* часть элементов должна присутствовать всегда, например SCL должен содержать всегда элемент Header
* шаблон уникальности элементов, например накладываемый на аттрибут name у IED запрещает наличие двух IED с одинаковыми значениями в name
* шаблон уникальности накладывается даже на группы элементов
* количественные ограничения, например элемент LN0 в LDevice должен быть только один
* шаблон исключения элементов, например элемент AccessPoint может содержать либо элемент Server, либо элемент ServerAt, либо список LN (логических узлов)

## Анализ раздела описания подсетей

Для раздела описания физических подсетей Solar имеет ряд своих проверок, включая корректность L2 и L3 параметров. С полным списком можно ознакомиться ниже:
* файл должен содержать элемент Communication, это соответствует событию _"В проекте не описан раздел коммуникаций. Проверка сетевых параметров блоков управления не будет проведена"_ со статусом _Ошибка_ 
* элемент Communication должен содержать хотя бы один элемент SubNetwork, это соответствует событию _"Элемент Communication должен содержать хотя бы один элемент SubNetwork"_ со статусом _Фатальная ошибка_
* элемент BitRate если он присутствует должен соответствовать трем правилам:
   * единица измерения имеет строгое значение "b/s"
   * множитель единицы измерения задается из следующего набора значений (" ", "m", "k", "M", "mu", "y", "z", "a", "f", "p", "n", "c", "d", "da", "h", "G", "T", "P", "E", "Z", "Y")
   * само значение обязательно и должны быть положительным целым числом
* элементы ConnectedAP должны содержаться в подсетях, это соответствует событию _"В сети не описано ни одной точки доступа (ConnectedAP)"_ со статусом _Ошибка_
* пара аттрибутов "apName" и "iedName" должна быть уникальны для каждой точки доступа в пределах одной подсети 
* аттрибут "iedName" должен начинаться с латинской буквы, далее вдобавок возможно использование символа "_" и цифр, исключение составляет слово "None" - это служебное слово в SCL
* также аттрибут "iedName" должен ссылаться на атрибут "name" одного из элементов IED в файле. Сопоставляется с _"Значение аттрибута iedName содержит ссылку, которую невозможно проследить. Аттрибут iedName в элементе ConnectedAP ссылается в никуда"_ со статусом _Ошибка_
* аттрибут "apName" должен начинаться с латинской буквы или цифры, далее вдобавок возможно использование символа "_"
* также аттрибут "apName" должен ссылаться на аттрибут "name" элемента AccessPoint элемента IED на который ссылается аттрибут "iedName". Сопоставляется с _"Значение аттрибута apName содержит ссылку, которую невозможно проследить. Аттрибут apName в элементе ConnectedAP ссылается в никуда"_ со статусом _Ошибка_
* для обеспечения точки доступа возможностью иметь сетевые параметры, в ней должен содержаться элемент Address, иначе Solar сгенерирует событие _"Элемент Address не сконфигурирован, родительский элемент ConnectedAP не имеет сетевых параметров"_ со статусом _Фатальная ошибка_ 
* контейнер Address может быть пустым, в таком случае Solar сгенерирует событие _"ConnectedAP не имеет сетевых параметров"_ со статусом _Фатальная ошибка_
* Solar проверяет на корректность три самых важных сетевых L3 параметра: IP-адрес, маску подсети и шлюз по умолчанию:
   * первоначально каждый из вышеописанных параметров должен состоять из четырех чисел от 0 до 255 разделенных символами "."
   * при отсутствии параметра Маска подсети Solar генерирует событие _"Маска подсети не сконфигурирована"_ со статусом _Ошибка_
   * маска подсети не должна содержать чередований, иначе Solar сгенерирует событие _"Нули и единицы в маске подсети не могут чередоваться"_ со статусом _Ошибка_
   * если Solar встречает отсутствующую конфигурацию шлюза, он генерирует событие _"Основной шлюз(Gateway) не сконфигурирован"_ со статусом _Ошибка_
   * если Solar встречает конфигурацию шлюза со значением 0.0.0.0, он понимает тчо это шлюз скорее всего неизвестное устройство и генерирует событие _"Основной шлюз(Gateway) имеет значение Routing to black hole"_ со статусом _Ошибка_
   * если Solar встречает значение 0.0.0.0 или не встречает значение в параметре IP-адрес, генерируется событие _"IP-адрес имеет значение 0.0.0.0 или не сконфигурирован"_ со статусом _Ошибка_
   * Solar выявляет нахождение шлюза и IP-адреса в разных сегментах сети, и выдает событие _"IP-адрес и основной шлюз(Gateway) шлюз/маска находятся в разных подсетях"_ со статусом _Ошибка_
   * Solar выдает статус _Предупреждение_ ситуациям _"IP-адрес совпадает с адресом подсети"_ и _"IP-адрес совпадает с широковещательным адресом подсети"_
   * кроме того IP-адреса должны быть уникальными, Solar показывает неуникальные IP-адреса и точки доступа которым они принадлежат, разбивая их на пары. То есть если существуют три точки доступа с одним IP-адресом Solar сгенерирует 2 события, первое о том что похожи первая и вторая и второе о том что походи вторая и третья
* точка доступа может не содержать ни одного элемента ControlBlock (блок управления), так как устройство может общаться с другими устройствами посредством MMS. Такой ситуации Solar присваивает статус _Предупреждение_ и генерирует событие _"Элемент ConnectedAP не содержит ни одного элемента GSE или SMV (блоки управления GOOSE или SV)"_
* пара аттрибутов "cbName" и "LDInst" должна быть уникальна для каждого блока управления в пределах одной точки доступа
* аттрибуты "cbName" и "LDInst" должны начинаться с латинской буквы или цифры, далее вдобавок возможно использование символа "_"
* также аттрибут "LDInst" должен ссылать на аттрибут inst одного из элемента LDevice идентифицированного по аттрибутам "iedName" и "apName" точки доступа. Сопоставляется с _"Аттрибут ldInst содержит ссылку на аттрибут inst элемента LDevice, которую не возможно проследить, возможно родительский элемент ConnectedAP содержит некорректные значения iedName и(или) apName, или аттрибут ldInst содержит некорректное значение"_ со статусом _Ошибка_ 
* также аттрибут "cbName" должен ссылать на аттрибут "name" соответствующего элемента GSEControl для GSE и SampledValueControl для SMV идентифицированного по аттрибутам "LDInst", "iedName" и "apName" блока управления и точки доступа. Сопоставляется с _"Значение аттрибута cbName содержит ссылку, которую невозможно проследить. Невозможно проследить ссылку в элементе GSEControl\SampledValueControl на аттрибут name, которого ссылается cbName, возможно родительский элемент ConnectedAP содержит некорректные значения iedName и(или) apName, или аттрибут cbName содержит некорректное значение"_ со статусом _Ошибка_
* для обеспечения блока управления возможностью иметь сетевые параметры, в ней должен содержаться элемент Address, иначе Solar сгенерирует событие _"Элемент Address не сконфигурирован, блок управления не имеет сетевых параметров" со статусом _Фатальная ошибка_
* контейнер Address может быть пустым, в таком случае Solar сгенерирует событие _"ConnectedAP не имеет сетевых параметров"_ со статусом _Фатальная ошибка_
* Solar проверяет на корректность четыре параметра блока управления: MAC-адрес, VLAN-ID, APPID и VLAN-Priority:
   * значение MAC-адреса должно быть представлено в виде хх-хх-хх-хх-хх-хх, где х - это шестнадцатеричное число
   * для GSE значение MAC-адреса должно быть в диапазоне от "01-0c-cd-01-00-00" до "01-0c-cd-01-01-ff", Solar маркирует это как _Ошибка_ и дает описание _"MAC-адрес должен находиться в диапазоне 010ccd010000 - 010ccd0101ff"_
   * для SMV значение MAC-адреса должно быть в диапазоне от "01-0c-cd-04-00-00" до "01-0c-cd-04-01-ff", Solar маркирует это как _Ошибка_ и дает описание _"MAC-адрес должен находиться в диапазоне 010ccd040000 - 010ccd0401ff"_
   * кроме того MAC-адреса должны быть уникальными, стратегия Solar такая же, как и при анализе IP-адресов
   * значение APPID должно быть шестнадцатеричным четырехразрядным числом
   * значение VLAN-ID должно быть шестнадцатеричным трех разрядным числом
   * значение VLAN-Priority должно быть десятичной цифрой от 0 до 7






## Анализ распределения нагрузки на виртуальные подсети
## Анализ раздела описания типов данных
## Анализ раздела описания истории изменений файла
## Анализ раздела описания моделей данных ИЭУ
## Анализ раздела описания однолинейных схем
## Анализ раздела входных сигналов для каждого ИЭУ
## Анализ избыточных или неиспользуемых элементов в наборах данных



Для того чтобы стало ясно мы рассмотрим некоторые типовые события при анализе файла

